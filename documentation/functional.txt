Here is the detailed Functional Requirement Document (FRD) based on the provided Business Requirement Document (BRD) and adhering to the "Coding Requirements" section:

**FR-DLT-001: Load Customer and Order Data to Delta Tables**

* **Title:** Load Customer and Order Data to Delta Tables
* **Description:** The system must read source CSV data from a specified volume and load it into Delta tables for customer and order data.
* **Preconditions:**
	+ CSV files are available at the specified locations: `/Volumes/gen_ai_poc_databrickscoe/sdlc_wizard/customerdata` and `/Volumes/gen_ai_poc_databrickscoe/sdlc_wizard/orderdata`
	+ The Delta tables for customer and order data do not have any existing data that needs to be preserved.
* **Main Flow / Functional Steps:**
	+ Read customer CSV data from `/Volumes/gen_ai_poc_databrickscoe/sdlc_wizard/customerdata` and load it into a Delta table named "customer".
	+ Read order CSV data from `/Volumes/gen_ai_poc_databrickscoe/sdlc_wizard/orderdata` and load it into a Delta table named "order".
	+ Remove "Null"/Null and duplicate records from both "customer" and "order" tables.

**FR-DLT-002: Create ordersummary Table and Load Data**

* **Title:** Create ordersummary Table and Load Data
* **Description:** The system must create an "ordersummary" table if it does not exist and load data into it by joining customer and order data.
* **Preconditions:**
	+ "customer" and "order" Delta tables are loaded with data.
	+ The "ordersummary" table does not exist or is empty.
* **Main Flow / Functional Steps:**
	+ Create the "ordersummary" table if it does not exist in the catalog "gen_ai_poc_databrickscoe" and schema "sdlc_wizard".
	+ Join "customer" and "order" data using the "CustId" field.
	+ Load the joined data into the "ordersummary" table, which is an SCD Type 2 table.

**FR-DLT-003: Implement SCD Type 2 Logic for ordersummary Table**

* **Title:** Implement SCD Type 2 Logic for ordersummary Table
* **Description:** The system must implement SCD Type 2 logic to update the "ordersummary" table when there are changes in the customer table.
* **Preconditions:**
	+ The "ordersummary" table is loaded with data.
	+ There are changes in the customer table.
* **Main Flow / Functional Steps:**
	+ Identify changes in the customer table.
	+ Update the "ordersummary" table by making old records Inactive and new records Active.
	+ Update the StartDate and EndDate accordingly.

**FR-DLT-004: Create customeraggregatespend Table and Load Aggregated Data**

* **Title:** Create customeraggregatespend Table and Load Aggregated Data
* **Description:** The system must create a "customeraggregatespend" table and load aggregated data into it from the "ordersummary" table.
* **Preconditions:**
	+ The "ordersummary" table is loaded with data.
	+ The "customeraggregatespend" table does not exist or is empty.
* **Main Flow / Functional Steps:**
	+ Create the "customeraggregatespend" table if it does not exist in the catalog "gen_ai_poc_databrickscoe" and schema "sdlc_wizard".
	+ Aggregate the "TotalAmount" column from the "ordersummary" table and group by "Name" and "Date" columns.
	+ Load the aggregated data into the "customeraggregatespend" table.

**FR-DLT-005: Implement Delta Live Tables (DLT)**

* **Title:** Implement Delta Live Tables (DLT)
* **Description:** The system must implement the above requirements using Delta Live Tables (DLT).
* **Preconditions:**
	+ All previous requirements are implemented.
* **Main Flow / Functional Steps:**
	+ Implement steps 1 to 9 using Delta Live Tables (DLT).